<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ObjectionSuccess (Stable)</title>
</head>
<body style="font-family: system-ui; padding: 30px; max-width: 700px; margin:auto;">

<h2>ObjectionSuccess</h2>

<select id="leadType">
  <option value="surprise">Surprise me</option>
  <option value="fsbo">FSBO</option>
  <option value="expired">Expired</option>
  <option value="canceled">Canceled</option>
  <option value="withdrawn">Withdrawn</option>
</select>

<br><br>

<button onclick="startCall()">Start Call</button>

<p id="status">Status: idle</p>

<script>

function setStatus(text) {
  document.getElementById("status").innerText = "Status: " + text;
}

async function startCall() {
  try {

    setStatus("Requesting audio...");

    const scenario = document.getElementById("leadType").value;

    let text = "Say hello clearly.";

    if (scenario === "fsbo") text = "You are a skeptical FSBO seller. Speak.";
    if (scenario === "expired") text = "You are frustrated your listing expired. Speak.";
    if (scenario === "canceled") text = "You distrust agents. Speak.";
    if (scenario === "withdrawn") text = "You are unsure what to do. Speak.";
    if (scenario === "surprise") text = "You are a difficult seller personality. Speak.";

    const response = await fetch("/tts", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text })
    });

    const blob = await response.blob();
    const audioUrl = URL.createObjectURL(blob);

    const audio = new Audio(audioUrl);
    await audio.play();

    setStatus("Done");

  } catch (e) {
    console.error(e);
    setStatus("Error");
  }
}

</script>

</body>
</html>
